<%#
# This file is part of the OpenWISP Captive Portal Manager
#
# Copyright (C) 2011 CASPUR (wifi@caspur.it)
#
# This software is licensed under a Creative  Commons Attribution-NonCommercial
# 3.0 Unported License.
#   http://creativecommons.org/licenses/by-nc/3.0/
#
# Please refer to the  README.license  or contact the copyright holder (CASPUR)
# for licensing details.
#
#%>

<fieldset class="form">
  <legend><%=t :allowed_traffic %></legend>

  <%= form_for([@captive_portal, @allowed_traffic]) do |f| %>
      <% if @allowed_traffic.errors.any? %>
          <h3 id="error_explanation" class="toggler atStart" style="color: #ff0000">
            <%= pluralize(@captive_portal.errors.count, "error") %>
          </h3>
          <h4 class="toggler atStart">
            <ul>
              <% @allowed_traffic.errors.full_messages.each do |msg| %>
                  <li><%= msg %></li>
              <% end %>
            </ul>
          </h4>
      <% end %>


      <p>
        <%= f.label :protocol %>
        <%= select :allowed_traffic,
                   :protocol,
                   [['tcp', 'tcp'], ['udp', 'udp']],
                   {:include_blank => 'None'}
        %>
      </p>
      <p>
        <%= f.label :source_mac_address %>
        <%= f.text_field :source_mac_address %>
      </p>
      <p>
        <%= f.label :source_host %>
        <%= f.text_field :source_host %>
      </p>
      <p>
        <%= f.label :source_port %>
        <%= f.text_field :source_port %>
      </p>
      <p>
        <%= f.label :destination_host %>
        <%= f.text_field :destination_host %>
      </p>
      <p>
        <%= f.label :destination_port %>
        <%= f.text_field :destination_port %>
      </p>

      <%= f.submit :class => :button %>

  <% end %>

</fieldset>
